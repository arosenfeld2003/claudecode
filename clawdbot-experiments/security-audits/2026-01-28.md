# Security Audit: 2026-01-28

**Clawdbot Version**: 2026.1.24-3 (885167d)
**Environment**: Docker container (node:22-slim)
**Audit Command**: `clawdbot security audit`

## Summary

| Severity | Count |
|----------|-------|
| Critical | 0 |
| Warning | 2 |
| Info | 1 |

## Warnings

### 1. gateway.trusted_proxies_missing
**Status**: Acknowledged (not applicable)

> Reverse proxy headers are not trusted. gateway.bind is loopback and gateway.trustedProxies is empty. If you expose the Control UI through a reverse proxy, configure trusted proxies so local-client checks cannot be spoofed.

**Assessment**: Not using a reverse proxy. Gateway is loopback-only inside Docker container. No action needed.

**Fix if needed**: Set `gateway.trustedProxies` to proxy IPs.

---

### 2. gateway.probe_failed
**Status**: Expected

> Gateway probe failed (deep). connect failed: connect ECONNREFUSED 127.0.0.1:18789

**Assessment**: Gateway service is not running. This is intentional - we're using the container for standalone scripts, not the full gateway infrastructure.

**Fix if needed**: Run `clawdbot gateway` to start the service.

---

## Info

### summary.attack_surface
**Status**: Good

```
groups: open=0, allowlist=0
tools.elevated: enabled
hooks: disabled
browser control: disabled
```

**Assessment**: Minimal attack surface. No open groups, no browser control. Elevated tools enabled but no channels configured to exploit them.

---

## Action Items

- [x] Fix state_dir permissions (chmod 700) - completed
- [ ] Consider disabling `tools.elevated` if not needed
- [ ] Re-audit after configuring any channels

## Next Audit

Schedule after:
- Adding messaging channels
- Enabling new skills
- Any configuration changes
